{% extends 'base.html.twig' %}

{% block title %}Hello IndexController!{% endblock %}

{% block body %}
{% if is_granted('ROLE_ADMIN') or is_granted('ROLE_CONTRIBUTOR') %}
    <style>
        .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
    </style>

    <div class="example-wrapper">
        <h3>PAGE PROTO</h3>

        le {{ proto.datetime|date('d/m/Y H:i') }}
        <br>
        <h1>{{ proto.titre| raw }}</h1>
        <br>
        {{ proto.contenue| raw }}
        <br>

        {% for img in images %}
            <img src="data:image/png;base64, {{ img.image }}">
            <br><br>
        {% endfor %}

        <br><br><br>

        <h3>Commentaire :</h3>
        {% for com in comments %}
            le {{ com.datetime|date('d/m/Y H:i') }} {{ com.envoyer.name }} dit : {{ com.contenue }}
            <br><br>
        {% endfor %}

        {% if app.user %}
            <button id="btnFormCom" class="btn btn-light" onclick="showFormCom()">laisser un commentaire</button> 

            <form id="formCom" action="commentaire" style="display: none">
                <textarea name="textComment" class="form-control" rows="3" placeholder="plouf"></textarea>
                
                <input type="hidden" name="type" value="proto"> 
                <input type="hidden" name="pageid" value="{{ proto.id }}"> 
                
                <button class="btn btn-light">envoyer</button> 
            </form>   
        {% endif %} 

    </div>
{% else %}
    <script>
        window.location.href = 'listeblog';
    </script>
{% endif %}
{% endblock %}

{% block javascripts %}
    <script>
        var visible=false;
        
        function showFormCom(){
            if (visible==false){
                document.getElementById("formCom").style.display = "block";
                visible=true;
            }else{
                document.getElementById("formCom").style.display = "none";
                visible=false;
            }
        }
    </script>
{% endblock %}
