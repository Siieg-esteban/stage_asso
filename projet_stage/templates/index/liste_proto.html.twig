{% extends 'base.html.twig' %}

{% block title %}Hello IndexController!{% endblock %}

{% block body %}
{% if is_granted('ROLE_ADMIN') or is_granted('ROLE_CONTRIBUTOR') %}
    <style>
        .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
    </style>

    {# listing #}
    <div class="example-wrapper">
        <h1>LISTE PROTO</h1>

        {% for proto in listeproto %} 
            <a href="pageproto{{ proto.id}}"><span>{{ proto.titre| raw}}</span> : <span>{{ proto.datetime|date('d/m/Y H:i') }}</span></a>
            
            {% if app.user %}
                {% if is_granted('ROLE_ADMIN') or proto.auteur == app.user %}
                    <a href="deletepage/proto/{{ proto.id }}" >Supprimer</a>
                    <a href="updatepage_proto_{{ proto.id }}" >Modifier</a>
                {% endif %}
            {% endif %}
            
            <br>
        {% endfor %}
    </div>

    {# form add proto #}
    <button id="btnFormProto" class="btn btn-primary" onclick="showFormProto()">Créer un nouveau proto !</button> 
    <div id="formProto" style="display: none">
        {{ form_start(form) }}
            {{ form_row(form.titre, {
                label: 'Titre du Prototype'
            }) }}
            {{ form_row(form.contenue, {
                label: 'Contenue de la page : '
            }) }}
            {{ form_row(form.mainimage, {
                label: 'Image principal : '
            }) }}
            {{ form_row(form.image, {
                label: 'Images : '
            }) }}
            <button type="submit" class="btn">Créer</button>
        {{ form_end(form) }}
    </div>
    
    {# redirect #}
{% else %}
    <script>
        window.location.href = 'listeblog';
    </script>
{% endif %}
{% endblock %}

{% block javascripts %}
    <script>
        var visible=false;
        
        function showFormProto(){
            if (visible==false){
                document.getElementById("formProto").style.display = "block";
                document.getElementById("btnFormProto").innerHTML = "Fermer";
                visible=true;
            }else{
                document.getElementById("formProto").style.display = "none";
                document.getElementById("btnFormProto").innerHTML = "Créer un nouveau proto !";
                visible=false;
            }
        }
    </script>
{% endblock %}

